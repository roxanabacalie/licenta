import csv
from shapely import Point, Polygon
from shapely.geometry import shape

iasi_polygon_data = {
	"type": "MultiPolygon",
	"coordinates": [
		[
			[
				[27.4884766, 47.1774687], [27.4955953, 47.1759272], [27.4996362, 47.1750522], [27.5073565, 47.1737724],
				[27.5158583, 47.1726191], [27.5173933, 47.1724736], [27.5200847, 47.1725168], [27.5199678, 47.1729973],
				[27.5195297, 47.1751409], [27.5191497, 47.1777717], [27.523466, 47.1773976], [27.5241009, 47.1772711],
				[27.5272189, 47.176985], [27.5280689, 47.1769449], [27.5281162, 47.1770231], [27.528589, 47.1770148],
				[27.5288473, 47.1770072], [27.5288543, 47.1768204], [27.5288937, 47.1767573], [27.5292996, 47.1766165],
				[27.5293509, 47.1765081], [27.5302844, 47.1765105], [27.5302747, 47.1762472], [27.5303474, 47.1762217],
				[27.530686, 47.1762686], [27.5306867, 47.176328], [27.5320797, 47.1764011], [27.5322038, 47.1758112],
				[27.5322633, 47.1747698], [27.5334618, 47.1747916], [27.5344387, 47.1749838], [27.5352196, 47.1750689],
				[27.5370761, 47.175061], [27.5365653, 47.1762593], [27.5365334, 47.1763085], [27.5363044, 47.1763566],
				[27.5355162, 47.1788739], [27.5340773, 47.1839423], [27.5317669, 47.1836679], [27.5315099, 47.1847904],
				[27.5314846, 47.1866211], [27.5316162, 47.1869204], [27.5311977, 47.188018], [27.5309969, 47.1893363],
				[27.5306053, 47.1903874], [27.5290546, 47.1903592], [27.5287464, 47.191987], [27.5277208, 47.1944861],
				[27.5275833, 47.1951469], [27.5274197, 47.195354], [27.5273178, 47.1956208], [27.5271358, 47.1964626],
				[27.5272312, 47.1966628], [27.5275031, 47.1969494], [27.5277438, 47.1973972], [27.5271129, 47.1972239],
				[27.5268362, 47.1982822], [27.5265989, 47.1985834], [27.5265356, 47.1991925], [27.5263835, 47.1996542],
				[27.526373, 47.1999159], [27.5265213, 47.2005356], [27.526753, 47.2010638], [27.5271899, 47.2014406],
				[27.5273104, 47.2016695], [27.5275544, 47.2018883], [27.5273325, 47.2020765], [27.5270747, 47.2025853],
				[27.5270786, 47.2031072], [27.5271717, 47.2032118], [27.5271335, 47.203662], [27.5272076, 47.2039193],
				[27.527177, 47.204012], [27.5268584, 47.2042842], [27.5266897, 47.2044049], [27.5262972, 47.2044651],
				[27.5250525, 47.2054636], [27.5252886, 47.2056648], [27.5250263, 47.2060784], [27.5254303, 47.2067809],
				[27.5255212, 47.2068256], [27.5249951, 47.2073224], [27.5247631, 47.2077335], [27.5237907, 47.2084742],
				[27.5236212, 47.2086877], [27.5233523, 47.2093507], [27.5231624, 47.2096448], [27.5263118, 47.2121212],
				[27.5276628, 47.2129007], [27.5278119, 47.2127474], [27.5279681, 47.2123912], [27.5281273, 47.211838],
				[27.5283079, 47.2116356], [27.5285145, 47.2115017], [27.5295266, 47.2120334], [27.5297505, 47.2122206],
				[27.5293655, 47.2127123], [27.5282585, 47.213338], [27.5267852, 47.2146311], [27.5263303, 47.214971],
				[27.5265008, 47.215074], [27.5242392, 47.2195758], [27.5230093, 47.2212074], [27.5226444, 47.2219398],
				[27.5210851, 47.2236336], [27.5209639, 47.2239309], [27.5208116, 47.2254919], [27.5207756, 47.2255339],
				[27.5203655, 47.2256208], [27.5203959, 47.225635], [27.5204732, 47.2257004], [27.5204797, 47.2259431],
				[27.5213803, 47.2259677], [27.5228004, 47.2260777], [27.5238153, 47.2262613], [27.5256382, 47.2266663],
				[27.5302914, 47.2279047], [27.5305289, 47.2274628], [27.5308394, 47.227072], [27.5319276, 47.2247663],
				[27.5335362, 47.2251402], [27.533434, 47.2253422], [27.5339797, 47.2254697], [27.5349072, 47.2256204],
				[27.5354637, 47.2254166], [27.5396454, 47.2268356], [27.5415711, 47.2255006], [27.5407828, 47.2251117],
				[27.5421878, 47.2221702], [27.5425302, 47.2218725], [27.5446392, 47.2226161], [27.545422, 47.2212292],
				[27.5467236, 47.221728], [27.5469995, 47.2213434], [27.5471905, 47.22111], [27.5484695, 47.2186766],
				[27.5486482, 47.2180998], [27.5488168, 47.2171674], [27.5490914, 47.2164519], [27.5496695, 47.2157549],
				[27.5504207, 47.2149027], [27.5507505, 47.2139567], [27.5507416, 47.2138696], [27.5515982, 47.2124055],
				[27.5520507, 47.2118965], [27.5522259, 47.2117853], [27.5522382, 47.2117071], [27.5526643, 47.21107],
				[27.5525243, 47.2110158], [27.5524731, 47.2108222], [27.5523328, 47.2102907], [27.5525483, 47.2099886],
				[27.5527103, 47.2094466], [27.5529518, 47.2089799], [27.5535295, 47.2084188], [27.5536567, 47.2083529],
				[27.5542075, 47.2075409], [27.5546203, 47.2065503], [27.5546166, 47.2063144], [27.5547193, 47.2060627],
				[27.5548398, 47.2058137], [27.5551349, 47.2054714], [27.5554997, 47.2043256], [27.5555008, 47.2042103],
				[27.5553548, 47.2040112], [27.5551463, 47.2039207], [27.5551706, 47.2038628], [27.5555215, 47.2039223],
				[27.5559042, 47.2040709], [27.5561968, 47.2042921], [27.5589918, 47.2060117], [27.5592582, 47.2060525],
				[27.5599578, 47.2044238], [27.560456, 47.203934], [27.5606295, 47.2033803], [27.5606199, 47.2032159],
				[27.5606644, 47.2031727], [27.56104, 47.2032758], [27.5615512, 47.2035609], [27.5619669, 47.203732],
				[27.5623208, 47.2039952], [27.5623142, 47.2042362], [27.5627811, 47.2044986], [27.5632388, 47.2051339],
				[27.5636919, 47.2054687], [27.5640932, 47.2056738], [27.5654953, 47.205964], [27.5663899, 47.2062085],
				[27.5648527, 47.208365], [27.566172, 47.2085634], [27.5663267, 47.2086299], [27.5663543, 47.2088421],
				[27.5659971, 47.2094917], [27.5660028, 47.2095707], [27.5668866, 47.2097316], [27.5685815, 47.2099405],
				[27.5685686, 47.2095333], [27.5683356, 47.2086011], [27.5684178, 47.2082532], [27.5734251, 47.2022215],
				[27.5796136, 47.2025749], [27.5800216, 47.2025441], [27.5802165, 47.2027085], [27.5803037, 47.2031196],
				[27.5813336, 47.2039328], [27.5823496, 47.2048256], [27.5829874, 47.2054768], [27.5836802, 47.2049047],
				[27.5842603, 47.2042861], [27.5845282, 47.2040754], [27.5849433, 47.2034455], [27.5851193, 47.2033075],
				[27.5856209, 47.2026714], [27.5862316, 47.2016895], [27.5868719, 47.2009612], [27.5873497, 47.2001613],
				[27.5878838, 47.1994305], [27.591078, 47.2003183], [27.5929683, 47.1974628], [27.5950917, 47.1938193],
				[27.5953065, 47.1936458], [27.5960979, 47.1932016], [27.5963584, 47.1932026], [27.5964256, 47.1933433],
				[27.5977852, 47.1937902], [27.5979216, 47.1938722], [27.6047285, 47.1947433], [27.6051646, 47.1947567],
				[27.6070858, 47.1950393], [27.6081313, 47.1952451], [27.6100579, 47.1954854], [27.6101212, 47.1954932],
				[27.6100747, 47.1954628], [27.612934, 47.1912786], [27.6270753, 47.1716816], [27.6289272, 47.1722909],
				[27.6298137, 47.1712933], [27.6299075, 47.1711684], [27.6298904, 47.1710263], [27.6300968, 47.1710791],
				[27.6311869, 47.1718732], [27.6321688, 47.172417], [27.6332067, 47.1727708], [27.6334587, 47.1725992],
				[27.6340348, 47.1720504], [27.6343179, 47.1715812], [27.6344196, 47.1711793], [27.6341475, 47.1709414],
				[27.6364344, 47.1694774], [27.6393528, 47.1683181], [27.6429392, 47.1668932], [27.6436638, 47.1668489],
				[27.6440732, 47.1669081], [27.6442792, 47.167079], [27.6443117, 47.1672518], [27.6442519, 47.1683323],
				[27.6444498, 47.1694962], [27.6444222, 47.1700774], [27.645402, 47.1705188], [27.6459268, 47.1712375],
				[27.6467653, 47.1719779], [27.6484294, 47.1736859], [27.6491198, 47.1746249], [27.6491964, 47.1748057],
				[27.6492859, 47.1754099], [27.6491679, 47.1759266], [27.6487094, 47.1771751], [27.6481888, 47.1788743],
				[27.6481284, 47.17954], [27.6481497, 47.1804786], [27.6519752, 47.1806398], [27.6523223, 47.1806937],
				[27.6525596, 47.1799706], [27.6526409, 47.1792921], [27.6527497, 47.1789089], [27.6523454, 47.1760634],
				[27.6524735, 47.1745705], [27.6527467, 47.1739241], [27.6533054, 47.1731824], [27.6538645, 47.1724718],
				[27.6543616, 47.1719567], [27.6549538, 47.1714523], [27.6555004, 47.1705718], [27.6556657, 47.1697588],
				[27.6556257, 47.1681752], [27.6545213, 47.1666822], [27.6536093, 47.1661917], [27.653463, 47.1660591],
				[27.6532925, 47.1652035], [27.6527629, 47.1646281], [27.6524042, 47.1643232], [27.6516883, 47.1638458],
				[27.6504523, 47.1636033], [27.6502233, 47.1634834], [27.6499686, 47.1631643], [27.6494377, 47.1626973],
				[27.6491786, 47.1618636], [27.6459714, 47.1608375], [27.6462666, 47.1605181], [27.6467132, 47.1603767],
				[27.6482416, 47.1603748], [27.6485972, 47.1604107], [27.6487428, 47.1603929], [27.6490108, 47.1602738],
				[27.6493371, 47.1598324], [27.6497973, 47.1593591], [27.6497998, 47.1589821], [27.6499602, 47.1586235],
				[27.6500114, 47.1583373], [27.6505961, 47.1580688], [27.6512067, 47.1575581], [27.6513983, 47.1575161],
				[27.6518598, 47.1575417], [27.65198, 47.1574915], [27.6526895, 47.1566536], [27.6529086, 47.1565499],
				[27.6532098, 47.1562928], [27.6532782, 47.1560124], [27.6533494, 47.1559412], [27.6543559, 47.155352],
				[27.6550361, 47.1539664], [27.6552973, 47.1531303], [27.6553711, 47.1529957], [27.6555779, 47.1529685],
				[27.6554912, 47.1524289], [27.6557734, 47.1524018], [27.6556419, 47.1514321], [27.6556983, 47.1512719],
				[27.6563291, 47.1512538], [27.6563198, 47.1510763], [27.6595071, 47.1509009], [27.6597127, 47.1507921],
				[27.6602196, 47.1509566], [27.6612062, 47.1509339], [27.6617834, 47.1507763], [27.6618537, 47.1517416],
				[27.665717, 47.1513794], [27.6656507, 47.1509098], [27.666226, 47.1508909], [27.6668803, 47.1505694],
				[27.6675553, 47.1503823], [27.6680479, 47.1505036], [27.6685028, 47.1511268], [27.6735929, 47.1506662],
				[27.6741345, 47.1506119], [27.674663, 47.1504987], [27.682693, 47.1482755], [27.6837055, 47.1482172],
				[27.6857217, 47.1483391], [27.685919, 47.1483013], [27.6868373, 47.1483597], [27.6870785, 47.1477562],
				[27.6873922, 47.1472356], [27.6879114, 47.1467325], [27.6897281, 47.1441661], [27.6906997, 47.1428315],
				[27.6915093, 47.1416018], [27.6920155, 47.1406689], [27.6907555, 47.1401999], [27.6894955, 47.1397308],
				[27.6894257, 47.1396129], [27.6858286, 47.1405437], [27.6832105, 47.140517], [27.6823515, 47.1405455],
				[27.6819536, 47.1405032], [27.681331, 47.1398922], [27.680619, 47.1400949], [27.6802882, 47.1398787],
				[27.6781237, 47.1389155], [27.6774398, 47.1391603], [27.6737368, 47.1376012], [27.6734649, 47.1373761],
				[27.6734414, 47.1372641], [27.674256, 47.1366589], [27.6748009, 47.1363788], [27.6748447, 47.13628],
				[27.6746642, 47.1356191], [27.6740054, 47.1357095], [27.6727626, 47.1361089], [27.6701083, 47.1372652],
				[27.6614535, 47.1406305], [27.6607814, 47.1408918], [27.6543774, 47.1406503], [27.6510967, 47.1404736],
				[27.6470887, 47.1403821], [27.6472005, 47.1393891], [27.6463996, 47.1393383], [27.6452321, 47.1393633],
				[27.6451767, 47.1393287], [27.6450725, 47.1389349], [27.6452878, 47.1374688], [27.6450587, 47.1374628],
				[27.6443357, 47.1375969], [27.6440683, 47.1376059], [27.643729, 47.1375285], [27.642005, 47.1376716],
				[27.6418958, 47.1377376], [27.6418734, 47.1379447], [27.6410831, 47.1380722], [27.6405362, 47.1382863],
				[27.6403817, 47.1381194], [27.6387492, 47.1382654], [27.6384764, 47.1375279], [27.6385755, 47.1375108],
				[27.6383676, 47.1367951], [27.6388001, 47.1367488], [27.6387465, 47.1365158], [27.6399604, 47.136153],
				[27.6400291, 47.136043], [27.6409249, 47.1358448], [27.6417675, 47.135791], [27.6418731, 47.1355442],
				[27.6426573, 47.1351438], [27.6431621, 47.1349416], [27.6438647, 47.1342032], [27.6444161, 47.1333002],
				[27.6450217, 47.1327708], [27.6454329, 47.1322206], [27.645594, 47.1316708], [27.6460446, 47.1307499],
				[27.6460377, 47.1305425], [27.6463715, 47.1297018], [27.646592, 47.1293064], [27.6471824, 47.1287063],
				[27.6472361, 47.1284329], [27.6482963, 47.1275069], [27.6485867, 47.12712], [27.6487049, 47.1266481],
				[27.6486789, 47.1262516], [27.6488753, 47.1258836], [27.6490815, 47.125248], [27.6498613, 47.1242307],
				[27.6493167, 47.1240338], [27.6492151, 47.1238166], [27.6492728, 47.1236557], [27.6510744, 47.1229956],
				[27.6501094, 47.1218278], [27.650984, 47.1217697], [27.6520379, 47.1217948], [27.6527568, 47.1216866],
				[27.6531479, 47.1215074], [27.65376, 47.1208261], [27.6542085, 47.1205866], [27.6550613, 47.1203407],
				[27.6559264, 47.1202175], [27.6578265, 47.1193815], [27.6587923, 47.1188641], [27.6592097, 47.1183785],
				[27.6596187, 47.1180739], [27.6602969, 47.1169262], [27.6602089, 47.1160286], [27.6601114, 47.1158578],
				[27.659672, 47.1154059], [27.6593057, 47.1146291], [27.6589723, 47.1142167], [27.6588501, 47.1137583],
				[27.6572912, 47.1133571], [27.657137, 47.1133719], [27.6564484, 47.113207], [27.6559632, 47.1129332],
				[27.6558173, 47.1127054], [27.6556785, 47.112201], [27.655643, 47.1117608], [27.655335, 47.1115908],
				[27.6543019, 47.111335], [27.6541444, 47.1110526], [27.6538692, 47.1109037], [27.6535981, 47.1108506],
				[27.6544738, 47.1104036], [27.655552, 47.1102009], [27.6559787, 47.1100547], [27.6565509, 47.110053],
				[27.6566363, 47.1100262], [27.6567342, 47.1098989], [27.6568504, 47.1098632], [27.6578414, 47.1099443],
				[27.6583239, 47.1097231], [27.6590103, 47.1095838], [27.6596643, 47.1093098], [27.6599099, 47.1092551],
				[27.6609655, 47.109338], [27.6628766, 47.1089239], [27.6632558, 47.1087948], [27.6637499, 47.1085243],
				[27.6641524, 47.1082317], [27.6645404, 47.1080555], [27.6653982, 47.1078989], [27.6655048, 47.1074435],
				[27.6653152, 47.1066058], [27.665224, 47.1054466], [27.6648007, 47.1032876], [27.664425, 47.10293],
				[27.6631798, 47.1020585], [27.6623681, 47.1016009], [27.6617757, 47.1014056], [27.6614866, 47.1012468],
				[27.6613522, 47.1010742], [27.6610351, 47.1010507], [27.6604007, 47.1009181], [27.6600415, 47.1016106],
				[27.6593158, 47.1015566], [27.6593753, 47.1011718], [27.6594691, 47.1009944], [27.659478, 47.1007907],
				[27.6593666, 47.100415], [27.659323, 47.1003727], [27.658538, 47.1004437], [27.6583093, 47.1005339],
				[27.6580559, 47.1003342], [27.6580205, 47.1000876], [27.6574675, 47.0991567], [27.6576688, 47.0990456],
				[27.6585812, 47.0987215], [27.6587311, 47.098737], [27.6588224, 47.0986852], [27.6589151, 47.0983762],
				[27.6585618, 47.0980602], [27.6581132, 47.0977848], [27.6575381, 47.0971527], [27.6575397, 47.0971142],
				[27.6576803, 47.0970621], [27.6576313, 47.0964871], [27.657786, 47.0963923], [27.6576677, 47.0959575],
				[27.6579103, 47.0953877], [27.6583067, 47.095021], [27.6585609, 47.0951035], [27.6590416, 47.0948275],
				[27.659157, 47.0947127], [27.6592089, 47.0946206], [27.6592551, 47.0938125], [27.6592186, 47.0936233],
				[27.6591272, 47.0935771], [27.6585633, 47.0936046], [27.658516, 47.0931544], [27.6583737, 47.093129],
				[27.6580619, 47.0928811], [27.6582396, 47.0921805], [27.6581922, 47.0920064], [27.6580382, 47.0918641],
				[27.6578303, 47.0917584], [27.6573092, 47.0916429], [27.657094, 47.0916358], [27.656535, 47.0920311],
				[27.6563527, 47.0919644], [27.6556296, 47.0914311], [27.6553518, 47.0917774], [27.6553272, 47.0919032],
				[27.6551493, 47.091978], [27.6547698, 47.0924066], [27.6545398, 47.0925816], [27.6542979, 47.092623],
				[27.6539007, 47.0924783], [27.6536129, 47.0925221], [27.6524573, 47.092156], [27.6525321, 47.091961],
				[27.6524828, 47.091855], [27.6523568, 47.0917826], [27.6521548, 47.0917749], [27.6514548, 47.0914243],
				[27.6512309, 47.0912495], [27.6516118, 47.0910337], [27.6524091, 47.0907876], [27.6524987, 47.0905267],
				[27.6525532, 47.0905213], [27.6525293, 47.0904075], [27.65229, 47.0903991], [27.6522382, 47.0902888],
				[27.6514492, 47.0897923], [27.6507696, 47.0894558], [27.6504693, 47.0891643], [27.6502982, 47.0891064],
				[27.6499083, 47.0891165], [27.649863, 47.089066], [27.6498458, 47.0889255], [27.6506113, 47.0888262],
				[27.6505095, 47.0886581], [27.6505677, 47.0884395], [27.6504387, 47.0884499], [27.6500176, 47.087453],
				[27.6499017, 47.0873128], [27.6492308, 47.0855618], [27.6492762, 47.085431], [27.6486885, 47.0854095],
				[27.6480552, 47.0852903], [27.6453029, 47.0849367], [27.6447486, 47.0848238], [27.644849, 47.0850257],
				[27.6448411, 47.0852721], [27.6445343, 47.0858476], [27.6445722, 47.0860166], [27.6438847, 47.0864929],
				[27.6437031, 47.0865551], [27.6437928, 47.0870198], [27.6440469, 47.0873215], [27.6443884, 47.0875089],
				[27.6444104, 47.0876568], [27.6443695, 47.087727], [27.6439438, 47.0880028], [27.6437553, 47.0879876],
				[27.6437178, 47.0880526], [27.6435936, 47.0880345], [27.6435174, 47.0880981], [27.6433556, 47.0879438],
				[27.6432563, 47.0879362], [27.6430622, 47.0883108], [27.6429338, 47.0883245], [27.6426409, 47.0882595],
				[27.6427204, 47.0889323], [27.6426565, 47.0889479], [27.6427607, 47.0891244], [27.6429316, 47.0892459],
				[27.6429014, 47.0893558], [27.6427319, 47.0894534], [27.6424706, 47.0894514], [27.6421009, 47.08952],
				[27.641806, 47.0897772], [27.6423869, 47.0900809], [27.6423823, 47.0901241], [27.6422818, 47.0901975],
				[27.6416883, 47.0900817], [27.64144, 47.0902502], [27.6413816, 47.0904013], [27.6412903, 47.0904615],
				[27.6408167, 47.0905258], [27.6405745, 47.0904647], [27.6398405, 47.0900593], [27.6390562, 47.0899298],
				[27.6389401, 47.0899571], [27.6384214, 47.0899028], [27.6382655, 47.0899778], [27.6382024, 47.090152],
				[27.6388099, 47.0904432], [27.6390402, 47.0904914], [27.6389925, 47.0908191], [27.6388068, 47.0910994],
				[27.6383596, 47.0912764], [27.6379552, 47.0910601], [27.6377954, 47.0910382], [27.6366406, 47.0910443],
				[27.6365022, 47.0910753], [27.6364455, 47.0911406], [27.6361784, 47.0915297], [27.6365576, 47.0916794],
				[27.6366411, 47.0919646], [27.6363691, 47.0923898], [27.6361405, 47.0925107], [27.6359824, 47.0928274],
				[27.6356893, 47.0931332], [27.6356029, 47.0934532], [27.6353376, 47.0937851], [27.6350882, 47.0939464],
				[27.6348823, 47.094347], [27.6349715, 47.0946954], [27.6354873, 47.094843], [27.6354214, 47.0949742],
				[27.6354968, 47.0952955], [27.6354102, 47.0955514], [27.635447, 47.0955938], [27.6350689, 47.0958894],
				[27.6350959, 47.0960942], [27.6349118, 47.0963161], [27.6347651, 47.0964084], [27.6346249, 47.0964267],
				[27.6344791, 47.0966478], [27.6340948, 47.0966474], [27.6336836, 47.0968507], [27.6331736, 47.0969343],
				[27.6328285, 47.097112], [27.6322128, 47.0970222], [27.6319595, 47.0971949], [27.631827, 47.0978946],
				[27.6316085, 47.0984006], [27.6314829, 47.0995691], [27.6312853, 47.0998813], [27.6310037, 47.100134],
				[27.6310449, 47.100233], [27.6307488, 47.1004478], [27.6306086, 47.1006151], [27.6305155, 47.1012039],
				[27.6302925, 47.1017369], [27.6298502, 47.1019609], [27.6288166, 47.1023088], [27.6285526, 47.1024957],
				[27.6286193, 47.1026538], [27.6282056, 47.102865], [27.6276214, 47.1030799], [27.6271321, 47.1028856],
				[27.6267802, 47.1028652], [27.6261204, 47.1027024], [27.6255462, 47.1027197], [27.6250351, 47.1026466],
				[27.6248503, 47.102682], [27.6245777, 47.1028607], [27.6243778, 47.1029284], [27.6244509, 47.1031087],
				[27.6244382, 47.1033304], [27.6240589, 47.1042086], [27.6237939, 47.1053034], [27.6234986, 47.1058246],
				[27.623334, 47.1059327], [27.6229551, 47.1058799], [27.6228304, 47.1058148], [27.6226087, 47.1053818],
				[27.6221815, 47.1053853], [27.6221165, 47.1057101], [27.6223148, 47.1059427], [27.6222583, 47.1061185],
				[27.620305, 47.1058345], [27.6200771, 47.1058898], [27.6199567, 47.1060289], [27.619954, 47.1061182],
				[27.6194277, 47.1061267], [27.6182101, 47.1056974], [27.61824, 47.1056595], [27.6181175, 47.1054018],
				[27.6179845, 47.1052277], [27.6177365, 47.1052241], [27.6168031, 47.1050552], [27.6164085, 47.1050416],
				[27.6145591, 47.1047769], [27.6137892, 47.1079921], [27.613829, 47.1081135], [27.6146797, 47.109174],
				[27.6144387, 47.1093689], [27.6131913, 47.1111361], [27.6125944, 47.1129204], [27.6125861, 47.1132563],
				[27.612454, 47.1138763], [27.6119564, 47.1157655], [27.6115036, 47.1203491], [27.6114981, 47.1206655],
				[27.6116003, 47.1206701], [27.6115993, 47.1207059], [27.6114203, 47.1207047], [27.6079414, 47.1198182],
				[27.6073284, 47.119991], [27.6074799, 47.1207501], [27.6074916, 47.1215428], [27.6076732, 47.1217253],
				[27.6080983, 47.1219883], [27.6083958, 47.1222988],
				[27.6083873, 47.1226924], [27.6086382, 47.1234343], [27.6086295, 47.1235489], [27.6085222, 47.1236741],
				[27.6077919, 47.1239522], [27.6076878, 47.123909],
				[27.6073491, 47.1235668], [27.6071695, 47.1228012], [27.6067557, 47.1226344], [27.6062692, 47.122588],
				[27.6058828, 47.1227366], [27.6058665, 47.1228252],
				[27.6054775, 47.1229111], [27.6055206, 47.12313], [27.6054711, 47.1231839], [27.6054801, 47.1235762],
				[27.6052659, 47.1237426], [27.6049045, 47.1239163],
				[27.6044545, 47.1240618], [27.6041838, 47.1241283], [27.6036478, 47.12426], [27.6036129, 47.1243251],
				[27.6036627, 47.1244225], [27.6032672, 47.1245687],
				[27.6031812, 47.1245623], [27.602985, 47.124399], [27.6028294, 47.1243586], [27.6027348, 47.124582],
				[27.6027705, 47.1247234], [27.602004, 47.1251445],
				[27.6011496, 47.1240409], [27.6009866, 47.123625], [27.6000504, 47.1237392], [27.5994542, 47.1238972],
				[27.5999531, 47.1247303], [27.5986513, 47.1251296],
				[27.5990376, 47.1259767], [27.5990925, 47.1262442], [27.5985358, 47.1266351], [27.5982278, 47.1268978],
				[27.5982428, 47.126949], [27.5955915, 47.1264303],
				[27.5955462, 47.126486], [27.5952196, 47.128414], [27.5950221, 47.1289207], [27.5948709, 47.1293082],
				[27.594993, 47.1296725], [27.5955407, 47.1296823],
				[27.595227, 47.130346], [27.5947985, 47.1317347], [27.5946172, 47.131855], [27.5944844, 47.1318685],
				[27.594189, 47.1314268], [27.5938414, 47.1305007],
				[27.5936737, 47.1302061], [27.5930476, 47.1294135], [27.5923114, 47.1282328], [27.5918976, 47.1278128],
				[27.5917919, 47.1275315], [27.5904279, 47.1280296],
				[27.5912454, 47.1294921], [27.5913456, 47.1297442], [27.5913484, 47.1299366], [27.5916816, 47.1306874],
				[27.5913983, 47.1308066], [27.5911485, 47.1313782],
				[27.5909359, 47.1315851], [27.5895531, 47.1320059], [27.589419, 47.1320806], [27.5893344, 47.1320441],
				[27.5879289, 47.130446], [27.5877927, 47.1301098],
				[27.5887214, 47.1298598], [27.5873449, 47.1277418], [27.587233, 47.1276668], [27.5869857, 47.1276863],
				[27.5867015, 47.1270616], [27.5843533, 47.1274803],
				[27.5843564, 47.1275397], [27.5840213, 47.1275592], [27.5838984, 47.1271786], [27.583774, 47.126794],
				[27.5831512, 47.1254581], [27.5827435, 47.1240699],
				[27.5827492, 47.1232083], [27.5829329, 47.1226504], [27.5833, 47.1221715], [27.5833426, 47.1220281],
				[27.5834795, 47.1209728], [27.5834103, 47.1203804],
				[27.5833872, 47.1180533], [27.583405, 47.1179043], [27.5836362, 47.1174774], [27.5836194, 47.1169063],
				[27.5839146, 47.116158], [27.5814105, 47.1164343],
				[27.5813656, 47.1165214], [27.5812924, 47.1165433], [27.5807958, 47.1165085], [27.5801457, 47.116298],
				[27.5798523, 47.1166508], [27.578924, 47.1160293],
				[27.578651, 47.1160605], [27.5780576, 47.1163521], [27.5776952, 47.116422], [27.5775252, 47.1164061],
				[27.5775589, 47.1159887], [27.5774914, 47.1156957],
				[27.5769136, 47.1148793], [27.5767005, 47.1144114], [27.576132, 47.1135655], [27.5741053, 47.1116111],
				[27.5739282, 47.1115247], [27.572343, 47.1102481],
				[27.5717626, 47.1098997], [27.5712827, 47.1095121], [27.5705195, 47.1087898], [27.570225, 47.1084105],
				[27.569611, 47.1072028], [27.5693338, 47.1063103],
				[27.5691995, 47.1055053], [27.5671346, 47.105424], [27.566427, 47.1052387], [27.5659321, 47.1051954],
				[27.561432, 47.1052514], [27.5597424, 47.105148],
				[27.5595971, 47.1079438], [27.5591172, 47.1096861], [27.5591278, 47.1100251], [27.5605415, 47.1119717],
				[27.5606016, 47.1131059], [27.5608808, 47.1137445],
				[27.5638311, 47.1184794], [27.5653155, 47.1206685], [27.5644735, 47.1209796], [27.5642633, 47.1212291],
				[27.563002, 47.1218556], [27.5624383, 47.1220325],
				[27.5619078, 47.1223979], [27.5601061, 47.1234711], [27.5599176, 47.1236865], [27.560101, 47.1238946],
				[27.5601472, 47.1238652], [27.5602527, 47.1239477],
				[27.5609035, 47.1245516], [27.5630721, 47.1256739], [27.5632253, 47.1255337], [27.5647272, 47.1262594],
				[27.5651253, 47.1263463], [27.5653139, 47.1268726],
				[27.5618807, 47.1294859], [27.5601009, 47.1307513], [27.5609045, 47.1315985], [27.5638224, 47.1344153],
				[27.553618, 47.1391923], [27.55358, 47.1392749],
				[27.5517447, 47.1402033], [27.5498248, 47.1412767], [27.5488155, 47.1418411], [27.5525885, 47.1452786],
				[27.5532269, 47.1458601], [27.5533523, 47.1460362],
				[27.5533024, 47.1460713], [27.5535587, 47.1463167], [27.5535138, 47.146445], [27.5455533, 47.1451448],
				[27.545245, 47.145121], [27.5449195, 47.1451183],
				[27.5397942, 47.1450734], [27.53922, 47.145025], [27.5387926, 47.1449206], [27.5387068, 47.1450751],
				[27.5388036, 47.1466643], [27.53887, 47.1468699],
				[27.539065, 47.1470312], [27.538988, 47.1475596], [27.5387516, 47.1474909], [27.537877, 47.1475769],
				[27.5374543, 47.1481479], [27.536882, 47.1497224],
				[27.5369695, 47.1501575], [27.5368061, 47.1510469], [27.5366956, 47.1510733], [27.5366696, 47.1511513],
				[27.5367066, 47.1512645], [27.5364678, 47.1513194],
				[27.5361991, 47.1514875], [27.5358663, 47.1514864], [27.5357769, 47.1517663], [27.5357349, 47.1527031],
				[27.5359176, 47.1527043], [27.5359971, 47.1529452],
				[27.5361418, 47.1531118], [27.5363539, 47.1532176], [27.536346, 47.1534911], [27.5366205, 47.1540321],
				[27.5367178, 47.1559752], [27.5366222, 47.1570394],
				[27.5363304, 47.1580919], [27.5359654, 47.1587333], [27.5357712, 47.1592056], [27.5355464, 47.159528],
				[27.5353639, 47.1600512], [27.5337594, 47.1602069],
				[27.5336287, 47.1602196], [27.5327908, 47.160206], [27.5314787, 47.1598563], [27.5306331, 47.1595823],
				[27.5303751, 47.1601512], [27.5280311, 47.159395],
				[27.527504, 47.1593041], [27.5261691, 47.1588864], [27.5251531, 47.1586848], [27.5214313, 47.1581342],
				[27.5197886, 47.1577777], [27.5188846, 47.1577033],
				[27.5156903, 47.1581283], [27.5147269, 47.1581471], [27.5131925, 47.1582885], [27.5099692, 47.1584624],
				[27.5069852, 47.1590174], [27.5059896, 47.1591438],
				[27.5005553, 47.1600258], [27.4994504, 47.1603209], [27.497455, 47.1603881], [27.4960337, 47.1601498],
				[27.4957794, 47.1601495], [27.4955031, 47.160216],
				[27.4949236, 47.160032], [27.4928131, 47.1601471], [27.4924755, 47.1600276], [27.4922463, 47.1597731],
				[27.4919641, 47.1602445], [27.4912634, 47.1608692],
				[27.4867596, 47.1630793], [27.4867604, 47.164193], [27.486626, 47.1668129], [27.4863967, 47.1677346],
				[27.4865658, 47.1687229], [27.4866764, 47.170223],
				[27.4867474, 47.1717784], [27.4866685, 47.1723844], [27.4853079, 47.1723764], [27.4848995, 47.1723145],
				[27.4848865, 47.1722074], [27.4847236, 47.1722168],
				[27.4847213, 47.1724041], [27.4844228, 47.1724446], [27.484459, 47.1726547], [27.482865, 47.1729419],
				[27.4813221, 47.1732931], [27.4815091, 47.1736034],
				[27.4801067, 47.1742258], [27.4790614, 47.1748383], [27.4787959, 47.1750463], [27.4779363, 47.1761641],
				[27.4774419, 47.1769061], [27.4767658, 47.1791788],
				[27.4767251, 47.1796871], [27.4765245, 47.1797901], [27.476595, 47.1801119], [27.4884766, 47.1774687]
			]
		]
	]
}


def process_stops(polygon_data, stops_data_file_path, output_file_path):
	iasi_polygon: Polygon = shape(polygon_data)

	# read stops data
	with open(stops_data_file_path, 'r', newline='', encoding='utf-8') as csvfile:
		reader = csv.DictReader(csvfile)
		stops_data = list(reader)

	# filter stops within Iasi and remove duplicates
	stops_within_iasi = {}
	for row in stops_data:
		lat = float(row['Stop Latitude'])
		lon = float(row['Stop Longitude'])
		point = Point(lon, lat)
		if point.within(iasi_polygon):
			stop_name = row['Stop Name'].strip()
			stop_id = row['Stop ID'].strip()
			if stop_name not in stops_within_iasi:
				stops_within_iasi[stop_name] = {
					'Stop ID': stop_id,
					'Stop Name': stop_name,
					'Stop Latitude': lat,
					'Stop Longitude': lon
				}

	# assign new consecutive IDs
	stops_with_consecutive_ids = []
	new_id = 1
	for stop in stops_within_iasi.values():
		stop['Stop ID'] = str(new_id)
		stops_with_consecutive_ids.append(stop)
		new_id += 1

	# write final stops data with consecutive IDs
	with open(output_file_path, 'w', newline='', encoding='utf-8') as csvfile:
		fieldnames = ['Stop ID', 'Stop Name', 'Stop Latitude', 'Stop Longitude']
		writer = csv.DictWriter(csvfile, fieldnames=fieldnames)
		writer.writeheader()
		writer.writerows(stops_with_consecutive_ids)

process_stops(iasi_polygon_data, "../../data/iasi/iasi_all_stops_data.csv", "../../data/iasi/iasi_filtered_stops_data.csv")